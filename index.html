<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindStep Pro | ××”×“×•×¨×ª 40 ×”×©×œ×‘×™×</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --sidebar-dark: #0f172a;
            --accent-blue: #0ea5e9;
            --bg-light: #f1f5f9;
        }

        body {
            font-family: 'Heebo', sans-serif;
            background-color: var(--bg-light);
            margin: 0;
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        #sidebar {
            width: 280px;
            background: var(--sidebar-dark);
            color: white;
            position: fixed;
            height: 100vh;
            right: 0; top: 0;
            display: flex;
            flex-direction: column;
            padding: 2rem 1.5rem;
            z-index: 1050;
            transition: transform 0.3s ease;
        }

        #sidebar-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            z-index: 1040;
        }

        #main-content {
            flex-grow: 1;
            margin-right: 280px;
            padding: 2rem;
            transition: margin 0.3s ease;
        }

        .category-card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            border: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: 0.3s;
            cursor: pointer;
            height: 100%;
        }
        .category-card:hover { transform: translateY(-5px); border: 2px solid var(--accent-blue); }
        .category-icon { font-size: 2.2rem; display: block; margin-bottom: 0.5rem; }

        .game-card {
            background: white;
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
        }

        .card-header-main {
            background: linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%);
            padding: 2.5rem 1.5rem;
            color: white;
            text-align: center;
        }

        .option-item {
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 1.2rem;
            margin-bottom: 0.8rem;
            cursor: pointer;
            transition: 0.2s;
            font-weight: 500;
        }
        .option-item:hover { border-color: var(--accent-blue); background: #f0f9ff; }
        .option-item.selected { border-color: var(--accent-blue); background: #e0f2fe; color: #0369a1; font-weight: 700; }

        .hidden { display: none !important; }

        @media (max-width: 992px) {
            #sidebar { transform: translateX(100%); }
            #sidebar.active { transform: translateX(0); }
            #sidebar.active + #sidebar-overlay { display: block; }
            #main-content { margin-right: 0; padding-top: 5rem; }
            .mobile-header { display: flex !important; }
        }

        .mobile-header {
            display: none;
            position: fixed;
            top: 0; right: 0; left: 0;
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body>

    <div class="mobile-header">
        <h4 class="m-0 fw-black">MindStep ğŸ§ </h4>
        <button class="btn btn-outline-dark" onclick="toggleSidebar()">â˜°</button>
    </div>

    <div id="sidebar-overlay" onclick="toggleSidebar()"></div>

    <aside id="sidebar">
        <h2 class="fw-black mb-5 text-center">MindStep <span class="text-info">Pro</span></h2>
        <button class="btn btn-light w-100 mb-4 fw-bold" onclick="showDashboard()">ğŸ  ×ª×¤×¨×™×˜ ×¨××©×™</button>
        <div class="stat-badge p-3 bg-white bg-opacity-10 rounded-4 mb-3">
            <small class="opacity-50">×©×œ×‘ ×¤×¢×™×œ</small>
            <div class="h6 m-0 fw-bold text-info" id="side-stage-name">×‘×—×¨ × ×•×©×</div>
        </div>
        <div class="stat-badge p-3 bg-white bg-opacity-10 rounded-4 mb-3">
            <small class="opacity-50">× ×™×§×•×“ ××¦×˜×‘×¨</small>
            <div class="h4 m-0 fw-bold text-success" id="side-score">0</div>
        </div>
        <div class="mt-auto">
            <button class="btn btn-outline-danger w-100 fw-bold py-3" onclick="resetGame()">âš ï¸ ××™×¤×•×¡ ×”×›×œ</button>
        </div>
    </aside>

    <main id="main-content">
        <div id="sec-dashboard">
            <div class="text-center mb-5">
                <h1 class="fw-black display-5">××¨×›×– ×”×œ××™×“×”</h1>
                <p class="text-muted fs-5">×‘×—×¨ ×§×˜×’×•×¨×™×” ×›×“×™ ×œ×”×ª×—×™×œ ×‘××ª×’×¨ ×”××§×¦×•×¢×™</p>
            </div>
            <div class="row g-4" id="dashboard-grid"></div>
        </div>

        <div id="sec-game" class="hidden">
            <div class="game-card">
                <div class="card-header-main">
                    <span class="badge bg-white text-primary mb-2 px-3 py-2" id="ui-stage-badge">×©×œ×‘ 1</span>
                    <h2 id="ui-title" class="fw-black m-0">×˜×•×¢×Ÿ...</h2>
                </div>
                <div class="card-body p-4 p-md-5">
                    <div class="progress mb-4" style="height: 10px; border-radius: 10px;">
                        <div id="ui-progress" class="progress-bar bg-info" style="width: 0%"></div>
                    </div>
                    <div id="ui-timer-box" class="text-center mb-4 hidden">
                        <span class="badge bg-danger p-2 fs-6">â³ ×–××Ÿ: <span id="ui-time">0</span></span>
                    </div>
                    <div id="sec-learning">
                        <div class="p-4 bg-light rounded-4 text-center mb-4 border">
                            <p class="h3 fw-normal lh-base" id="ui-fact"></p>
                        </div>
                        <button class="btn btn-primary btn-lg w-100 py-3" onclick="nextFact()">×”×‘× ×ª×™, ×”××©×š â”</button>
                    </div>
                    <div id="sec-quiz" class="hidden">
                        <h4 id="ui-question" class="mb-4 fw-bold text-secondary text-center"></h4>
                        <div id="ui-options" class="row g-2"></div>
                        <div id="ui-feedback" class="text-center my-3 fw-bold fs-4"></div>
                        <button id="ui-quiz-btn" class="btn btn-primary btn-lg w-100 mt-3" onclick="checkQuiz()">××©×¨ ×ª×©×•×‘×”</button>
                    </div>
                    <div id="sec-victory" class="hidden text-center py-5">
                        <h1 class="display-3">ğŸ†</h1>
                        <h2 class="fw-black text-primary">×”×©×œ×‘ ×”×•×©×œ×!</h2>
                        <p class="h4 text-muted mb-5" id="ui-victory-msg"></p>
                        <button class="btn btn-success btn-lg px-5" onclick="startNextStage()">×œ×©×œ×‘ ×”×‘×</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

<script>
    const stages = [
        // ×§×˜×’×•×¨×™×”: ×˜×›× ×•×œ×•×’×™×” ×•××—×©×‘×™×
        { name: "×œ×•×’×™×§×” ×“×™×’×™×˜×œ×™×ª", category: "tech", icon: "ğŸ’»", type: "timed", timeLimit: 30, data: [
            { fact: "×©×¢×¨ ×œ×•×’×™ AND ××•×¦×™× ×¢×¨×š '1' ×¨×§ ×‘××™×“×” ×•×›×œ ×›× ×™×¡×•×ª×™×• ×”×Ÿ '1'.", question: "××”×• ×ª× ××™ ×”×™×¦×™××” ×©×œ ×©×¢×¨ AND ×œ×××ª?", options: ["×œ×¤×—×•×ª ×›× ×™×¡×” ××—×ª ×××ª", "×›×œ ×”×›× ×™×¡×•×ª ×××ª", "×›×©××™×Ÿ ×›× ×™×¡×•×ª", "×ª××™×“"], answer: "×›×œ ×”×›× ×™×¡×•×ª ×××ª" },
            { fact: "×©×¢×¨ XOR ××•×¦×™× '1' ×¨×§ ×›××©×¨ ×”×›× ×™×¡×•×ª ×©×•× ×•×ª ×–×• ××–×•.", question: "××” ××•×¦×™× ×©×¢×¨ XOR ×‘×¢×¨×›×™× (1,1)?", options: ["1", "0", "××™×Ÿ ×™×¦×™××”", "×ª×œ×•×™ ×‘×–×¨×"], answer: "0" },
            { fact: "××¢×¨×›×ª ×‘×™× ××¨×™×ª ×¤×•×¢×œ×ª ×‘×‘×¡×™×¡ 2, ×”××™×™×¦×’×ª ××ª×— ×’×‘×•×” (1) ×•× ××•×š (0).", question: "×›××” ×¡×¤×¨×•×ª ×©×•× ×•×ª ×§×™×™××•×ª ×‘×‘×¡×™×¡ ×”×‘×™× ××¨×™?", options: ["10", "1", "2", "8"], answer: "2" },
            { fact: "×¨×›×™×‘ ×”-Flip-Flop ××©××© ×›×™×—×™×“×ª ×”×–×™×›×¨×•×Ÿ ×”×‘×¡×™×¡×™×ª ×‘×™×•×ª×¨ ×‘××¢×’×œ×™× ×œ×•×’×™×™×.", question: "××”×• ×”×ª×¤×§×™×“ ×”×¢×™×§×¨×™ ×©×œ Flip-Flop?", options: ["×—×™×©×•×‘ ××ª××˜×™", "×©××™×¨×ª ××¦×‘ (×–×™×›×¨×•×Ÿ)", "×”××¨×ª ××ª×—", "×§×™×¨×•×¨ ×”××¢×‘×“"], answer: "×©××™×¨×ª ××¦×‘ (×–×™×›×¨×•×Ÿ)" }
        ]},
        { name: "××¨×›×™×˜×§×˜×•×¨×ª ××—×©×‘", category: "tech", icon: "âš™ï¸", type: "normal", data: [
            { fact: "×”-ALU ×”×•× ×”×—×œ×§ ×‘××¢×‘×“ ×”××—×¨××™ ×¢×œ ×‘×™×¦×•×¢ ×¤×¢×•×œ×•×ª ×—×©×‘×•× ×™×•×ª ×•×œ×•×’×™×•×ª.", question: "××” ××™×™×¦×’×•×ª ×¨××©×™ ×”×ª×™×‘×•×ª ALU?", options: ["Access Logic Unit", "Arithmetic Logic Unit", "Array Line Unit", "Automatic Link User"], answer: "Arithmetic Logic Unit" },
            { fact: "×–×™×›×¨×•×Ÿ ×”-Cache ×”×•× ×–×™×›×¨×•×Ÿ ××”×™×¨ ×•×§×˜×Ÿ ×”××©××© ×œ×¦××¦×•× ×–××Ÿ ×”×’×™×©×” ×œ× ×ª×•× ×™×.", question: "××”×• ×”×™×ª×¨×•×Ÿ ×”××¨×›×–×™ ×©×œ ×–×™×›×¨×•×Ÿ Cache?", options: ["× ×¤×— ×¢×¦×•×", "×¢×œ×•×ª × ××•×›×”", "××”×™×¨×•×ª ×’×™×©×” ×’×‘×•×”×”", "×¢××™×“×•×ª ×‘××™×"], answer: "××”×™×¨×•×ª ×’×™×©×” ×’×‘×•×”×”" },
            { fact: "××•×˜×•×‘×•×¡ × ×ª×•× ×™× (Data Bus) ×”×•× ××¢×¨×›×ª ×”××¢×‘×™×¨×” × ×ª×•× ×™× ×‘×™×Ÿ ×¨×›×™×‘×™ ×”××—×©×‘.", question: "××”×• ×ª×¤×§×™×“ ×”-Data Bus?", options: ["×§×™×¨×•×¨", "×”×¢×‘×¨×ª ××™×“×¢ ×‘×™×Ÿ ×¨×›×™×‘×™×", "××¡×¤×§×ª ×—×©××œ", "×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜"], answer: "×”×¢×‘×¨×ª ××™×“×¢ ×‘×™×Ÿ ×¨×›×™×‘×™×" },
            { fact: "×”-BIOS ×”×•× ×”×§×•×“ ×”×¨××©×•×Ÿ ×©××¨×™×¥ ×”××—×©×‘ ×‘×¢×ª ×”×“×œ×§×ª×•.", question: "××ª×™ ×¤×•×¢×œ ×”-BIOS?", options: ["×‘×–××Ÿ ×’×œ×™×©×”", "×‘×¢×ª ×›×™×‘×•×™", "××™×“ ×¢× ×”×”×“×œ×§×”", "×‘×–××Ÿ ×”×ª×§× ×ª ××©×—×§"], answer: "××™×“ ×¢× ×”×”×“×œ×§×”" }
        ]},
        { name: "×ª×›× ×•×ª ×•××™× ×˜×¨× ×˜", category: "tech", icon: "ğŸŒ", type: "normal", data: [
            { fact: "×¤×¨×•×˜×•×§×•×œ HTTP ××©××© ×œ×”×¢×‘×¨×ª ×”×™×¤×¨-×˜×§×¡×˜ ×‘×¨×©×ª ×”××™× ×˜×¨× ×˜.", question: "××”×• ×ª×¤×§×™×“×• ×©×œ ×¤×¨×•×˜×•×§×•×œ HTTP?", options: ["×©×œ×™×—×ª ××™××™×™×œ", "×”×¢×‘×¨×ª ×“×¤×™ ××™× ×˜×¨× ×˜", "××‘×˜×—×ª ×§×‘×¦×™×", "×—×™×‘×•×¨ ×—×•××¨×”"], answer: "×”×¢×‘×¨×ª ×“×¤×™ ××™× ×˜×¨× ×˜" },
            { fact: "×©×¤×ª Python ×”×™× ×©×¤×” ××¤×•×¨×©×ª (Interpreted) ×‘×¢×œ×ª ×˜×™×¤×•×¡×™×•×ª ×“×™× ××™×ª.", question: "××™×–×• ×ª×›×•× ×” ×××¤×™×™× ×ª ××ª Python?", options: ["×©×¤×ª ××›×•× ×”", "×©×¤×” ××¤×•×¨×©×ª", "×©×¤×” ×œ×œ× ×¤×•× ×§×¦×™×•×ª", "××—×™×™×‘×ª × ×™×”×•×œ ×–×™×›×¨×•×Ÿ ×™×“× ×™"], answer: "×©×¤×” ××¤×•×¨×©×ª" },
            { fact: "××¡×“×™ × ×ª×•× ×™× ×¨×œ×¦×™×•× ×™×™× ××©×ª××©×™× ×‘×©×¤×ª SQL ×œ× ×™×”×•×œ ×•×©××™×œ×ª×•×ª.", question: "××”×™ ××˜×¨×ª ×©×¤×ª SQL?", options: ["×¢×™×¦×•×‘ ××ª×¨×™×", "×©××™×œ×ª×•×ª ×‘××¡×“×™ × ×ª×•× ×™×", "×‘× ×™×™×ª ××¢×‘×“×™×", "×™×¦×™×¨×ª ×× ×™××¦×™×”"], answer: "×©××™×œ×ª×•×ª ×‘××¡×“×™ × ×ª×•× ×™×" },
            { fact: "×›×ª×•×‘×ª IP ×‘×’×¨×¡×” 4 (IPv4) ××•×¨×›×‘×ª ×-32 ×¡×™×‘×™×•×ª.", question: "×›××” ×¡×™×‘×™×•×ª ×™×© ×‘×›×ª×•×‘×ª IPv4?", options: ["16", "32", "64", "128"], answer: "32" }
        ]},

        // ×§×˜×’×•×¨×™×”: ××“×¢ ×•×¤×™×–×™×§×”
        { name: "×¤×™×–×™×§×” ×§×™× ××˜×™×ª", category: "science", icon: "ğŸ“", type: "normal", data: [
            { fact: "××”×™×¨×•×ª ×”×™× ×”×•×•×§×˜×•×¨ ×”××™×™×¦×’ ××ª ×§×¦×‘ ×©×™× ×•×™ ×”×”×¢×ª×§ ×‘×–××Ÿ.", question: "××” ××‘×“×™×œ ××”×™×¨×•×ª (Velocity) ×××”×™×¨×•×ª (Speed)?", options: ["×–××Ÿ", "×›×™×•×•×Ÿ", "××©×§×œ", "×× ×¨×’×™×”"], answer: "×›×™×•×•×Ÿ" },
            { fact: "×ª××•×¦×” ××•×’×“×¨×ª ×›×§×¦×‘ ×©×™× ×•×™ ×”××”×™×¨×•×ª ×©×œ ×’×•×£ ×œ××•×¨×š ×–××Ÿ.", question: "××”×™ ×”×™×—×™×“×” ×”×¡×˜× ×“×¨×˜×™×ª ×œ×ª××•×¦×”?", options: ["m/s", "km/h", "m/sÂ²", "Newton"], answer: "m/sÂ²" },
            { fact: "×‘× ×¤×™×œ×” ×—×•×¤×©×™×ª (×œ×œ× ×”×ª× ×’×“×•×ª ××•×•×™×¨), ×›×œ ×”×’×•×¤×™× ×××™×¦×™× ×‘××•×ª×• ×§×¦×‘.", question: "××”×™ ×ª××•×¦×ª ×”×›×•×‘×“ ×”×××•×¦×¢×ª ×‘×›×“×•×¨ ×”××¨×¥?", options: ["5 m/sÂ²", "9.8 m/sÂ²", "12 m/sÂ²", "0 m/sÂ²"], answer: "9.8 m/sÂ²" },
            { fact: "×”×—×•×§ ×”×¨××©×•×Ÿ ×©×œ × ×™×•×˜×•×Ÿ ×§×•×‘×¢ ×©×’×•×£ ×™×©××£ ×œ×©××•×¨ ×¢×œ ××¦×‘ ×ª× ×•×¢×ª×• (×”×ª××“×”).", question: "××™×š × ×§×¨××ª ×”× ×˜×™×™×” ×©×œ ×’×•×£ ×œ×”×ª× ×’×“ ×œ×©×™× ×•×™ ×‘×ª× ×•×¢×”?", options: ["×× ×¨×’×™×”", "×—×™×›×•×š", "×”×ª××“×” (Inertia)", "×›×‘×™×“×”"], answer: "×”×ª××“×” (Inertia)" }
        ]},
        { name: "×× ×¨×’×™×” ×•×ª×¨××•×“×™× ××™×§×”", category: "science", icon: "ğŸ”¥", type: "normal", data: [
            { fact: "×—×•×§ ×©×™××•×¨ ×”×× ×¨×’×™×” ×§×•×‘×¢ ×›×™ ×× ×¨×’×™×” ××™× ×” × ×•×¦×¨×ª ××• × ×¢×œ××ª, ××œ× ××©× ×” ×¦×•×¨×”.", question: "××” ×§×•×¨×” ×œ×× ×¨×’×™×” ×‘××¢×¨×›×ª ×¡×’×•×¨×”?", options: ["×”×™× ××ª××“×”", "×”×™× ××©× ×” ×¦×•×¨×”", "×”×™× ×’×“×œ×”", "×”×™× × ×¢×œ××ª"], answer: "×”×™× ××©× ×” ×¦×•×¨×”" },
            { fact: "×”××¤×¡ ×”××•×—×œ×˜ ×”×•× ×”×˜××¤×¨×˜×•×¨×” ×”× ××•×›×” ×‘×™×•×ª×¨ ×”××¤×©×¨×™×ª, ×©×‘×” × ×¢×¦×¨×ª ×ª× ×•×¢×ª ×”××•×œ×§×•×œ×•×ª.", question: "××”×• ×¢×¨×š ×”××¤×¡ ×”××•×—×œ×˜ ×‘×¦×œ×–×™×•×¡?", options: ["0", "-100", "-273.15", "-459"], answer: "-273.15" },
            { fact: "×× ×¨×’×™×” ×§×™× ×˜×™×ª ×”×™× ×”×× ×¨×’×™×” ×©×™×© ×œ×’×•×£ ×¢×§×‘ ×ª× ×•×¢×ª×•.", question: "×‘××” ×ª×œ×•×™×” ×”×× ×¨×’×™×” ×”×§×™× ×˜×™×ª?", options: ["×’×•×‘×” ×‘×œ×‘×“", "××¡×” ×•××”×™×¨×•×ª", "×¦×‘×¢ ×”×’×•×£", "×˜××¤×¨×˜×•×¨×” ×‘×œ×‘×“"], answer: "××¡×” ×•××”×™×¨×•×ª" },
            { fact: "×”×•×œ×›×ª ×—×•× ×”×™× ××¢×‘×¨ ×× ×¨×’×™×” ×ª×¨××™×ª ×‘×™×Ÿ ×’×•×¤×™× ×”× ××¦××™× ×‘××’×¢ ×™×©×™×¨.", question: "××™×–×” ×—×•××¨ ××•×œ×™×š ×—×•× ×‘×¦×•×¨×” ×”×˜×•×‘×” ×‘×™×•×ª×¨?", options: ["×¢×¥", "×–×›×•×›×™×ª", "××ª×‘×ª", "×¤×œ×¡×˜×™×§"], answer: "××ª×‘×ª" }
        ]},
        { name: "××•×¤×˜×™×§×” ×•××•×¨", category: "science", icon: "ğŸ”¦", type: "normal", data: [
            { fact: "×©×‘×™×¨×ª ××•×¨ ××ª×¨×—×©×ª ×›××©×¨ ××•×¨ ×¢×•×‘×¨ ×‘×™×Ÿ ×©× ×™ ×ª×•×•×›×™× ×‘×¢×œ×™ ×¦×¤×™×¤×•×ª ×©×•× ×”.", question: "××” ×’×•×¨× ×œ××•×¨ ×œ×”×ª×›×•×¤×£ ×‘××¢×‘×¨ ×××™× ×œ××•×•×™×¨?", options: ["×”×©×ª×§×¤×•×ª", "×©×‘×™×¨×”", "×‘×œ×™×¢×”", "×§×™×˜×•×‘"], answer: "×©×‘×™×¨×”" },
            { fact: "××”×™×¨×•×ª ×”××•×¨ ×‘×¨×™×§ ×”×™× ×§×‘×•×¢ ×¤×™×–×™×§×œ×™ ×”×¢×•××“ ×¢×œ ×›-300,000 ×§×™×œ×•××˜×¨ ×œ×©× ×™×™×”.", question: "××” × ×¢ ××”×¨ ×™×•×ª×¨ ××”××•×¨ ×‘×¨×™×§?", options: ["×§×•×œ", "××œ×§×˜×¨×•× ×™×", "×©×•× ×“×‘×¨", "×’×œ×™ ×¨×“×™×•"], answer: "×©×•× ×“×‘×¨" },
            { fact: "××•×¨ ×œ×‘×Ÿ ××•×¨×›×‘ ×œ××¢×©×” ××›×œ ×¦×‘×¢×™ ×”×§×©×ª (×”×¡×¤×§×˜×¨×•× ×”× ×¨××”).", question: "××™×–×” ××›×©×™×¨ ××©××© ×œ×¤×™×¨×•×§ ××•×¨ ×œ×‘×Ÿ ×œ×¦×‘×¢×™×•?", options: ["××¨××”", "×¢×“×©×” ××¨×›×–×ª", "×× ×¡×¨×” (Prism)", "××¡× ×Ÿ"], answer: "×× ×¡×¨×” (Prism)" },
            { fact: "×§×¨×™× ×” ××œ×§×˜×¨×•××’× ×˜×™×ª ×›×•×œ×œ×ª ×’×œ×™ ×¨×“×™×•, ××™×§×¨×•×’×œ, ××•×¨ × ×¨××” ×•×§×¨×™× ×ª ×¨× ×˜×’×Ÿ.", question: "××™×–×• ×§×¨×™× ×” ×‘×¢×œ×ª ×”×× ×¨×’×™×” ×”×’×‘×•×”×” ×‘×™×•×ª×¨?", options: ["×¨×“×™×•", "××•×¨ × ×¨××”", "×’××", "××™× ×¤×¨×-××“×•×"], answer: "×’××" }
        ]},

        // ×§×˜×’×•×¨×™×”: ××ª××˜×™×§×”
        { name: "××œ×’×‘×¨×” ×•×—×©×‘×•×Ÿ", category: "math", icon: "â—", type: "normal", data: [
            { fact: "×—×•×§ ×”×¤×™×œ×•×’ ×××¤×©×¨ ×œ×¤×©×˜ ×‘×™×˜×•×™×™× ××ª××˜×™×™× ×¢×œ ×™×“×™ ×›×¤×œ ××™×‘×¨ ×‘×¡×•×’×¨×™×™×.", question: "××”×• ×”×‘×™×˜×•×™ ×”×¤×©×•×˜ ×œ-a(b+c)?", options: ["ab+c", "ab+ac", "abc", "a+b+c"], answer: "ab+ac" },
            { fact: "××¡×¤×¨ ×¨××©×•× ×™ ×”×•× ××¡×¤×¨ ×˜×‘×¢×™ ×”×’×“×•×œ ×-1 ×©××ª×—×œ×§ ×¨×§ ×‘×¢×¦××• ×•×‘-1.", question: "××”×• ×”××¡×¤×¨ ×”×¨××©×•× ×™ ×”×–×•×’×™ ×”×™×—×™×“?", options: ["0", "1", "2", "4"], answer: "2" },
            { fact: "×—×–×§×” ××™×™×¦×’×ª ×›×¤×œ ×—×•×–×¨ ×©×œ ××¡×¤×¨ ×‘×¢×¦××•.", question: "××”×• ×”×¢×¨×š ×©×œ 2 ×‘×—×–×§×ª 5?", options: ["10", "16", "32", "64"], answer: "32" },
            { fact: "×‘××©×•×•××” ×¨×™×‘×•×¢×™×ª, ×”×“×™×¡×§×¨×™××™× × ×˜×” ×§×•×‘×¢×ª ××ª ××¡×¤×¨ ×”×¤×ª×¨×•× ×•×ª.", question: "×›××” ×¤×ª×¨×•× ×•×ª ×™×© ×œ××©×•×•××” ×× ×”×“×™×¡×§×¨×™××™× × ×˜×” ×©×œ×™×œ×™×ª?", options: ["1", "2", "××™×Ÿ ×¤×ª×¨×•×Ÿ ×××©×™", "××™× ×¡×•×£"], answer: "××™×Ÿ ×¤×ª×¨×•×Ÿ ×××©×™" }
        ]},
        { name: "×’×™××•××˜×¨×™×” ×•×˜×¨×™×’×•× ×•××˜×¨×™×”", category: "math", icon: "ğŸ“", type: "normal", data: [
            { fact: "××©×¤×˜ ×¤×™×ª×’×•×¨×¡ ×§×•×‘×¢ ××ª ×”×§×©×¨ ×‘×™×Ÿ ×”×¦×œ×¢×•×ª ×‘××©×•×œ×© ×™×©×¨ ×–×•×•×™×ª.", question: "××”×™ ×”× ×•×¡×—×” ×©×œ ××©×¤×˜ ×¤×™×ª×’×•×¨×¡?", options: ["a+b=c", "aÂ²+bÂ²=cÂ²", "ab=c", "2a+2b=c"], answer: "aÂ²+bÂ²=cÂ²" },
            { fact: "×¡×›×•× ×”×–×•×•×™×•×ª ×”×¤× ×™××™×•×ª ×‘×›×œ ××©×•×œ×© ×”×•× ×ª××™×“ 180 ××¢×œ×•×ª.", question: "××”×• ×¡×›×•× ×”×–×•×•×™×•×ª ×‘××¨×•×‘×¢ ×§××•×¨?", options: ["180", "270", "360", "540"], answer: "360" },
            { fact: "×¤×•× ×§×¦×™×™×ª ×”×¡×™× ×•×¡ ××™×™×¦×’×ª ××ª ×”×™×—×¡ ×‘×™×Ÿ ×”× ×™×¦×‘ ××•×œ ×”×–×•×•×™×ª ×œ×™×ª×¨.", question: "×‘××©×•×œ×© ×™×©×¨ ×–×•×•×™×ª, ××”×• ×¡×™× ×•×¡ ×©×œ 90 ××¢×œ×•×ª?", options: ["0", "0.5", "1", "××™× ×¡×•×£"], answer: "1" },
            { fact: "×¨×“×™×•×¡ ×”××¢×’×œ ×”×•× ×”××¨×—×§ ×××¨×›×–×• ×œ×›×œ × ×§×•×“×” ×¢×œ ×”×”×™×§×£.", question: "××™×š ××—×©×‘×™× ××ª ×©×˜×— ×”××¢×’×œ?", options: ["2Ï€r", "Ï€rÂ²", "Ï€d", "rÂ²"], answer: "Ï€rÂ²" }
        ]},

        // ×§×˜×’×•×¨×™×”: ×”×™×¡×˜×•×¨×™×” ×•×ª×¨×‘×•×ª
        { name: "××¦×¨×™× ×”×¢×ª×™×§×”", category: "history", icon: "ğŸª", type: "normal", data: [
            { fact: "×”×¤×™×¨××™×“×” ×”×’×“×•×œ×” ×©×œ ×’×™×–×” ×”×™× ×”×¢×ª×™×§×” ××‘×™×Ÿ ×©×‘×¢×ª ×¤×œ××™ ×ª×‘×œ.", question: "×¢×‘×•×¨ ××™ × ×‘× ×ª×” ×”×¤×™×¨××™×“×” ×”×’×“×•×œ×”?", options: ["×ª×•×ª ×¢× ×—' ×××•×Ÿ", "×—'×•×¤×•", "×¨×¢××¡×¡ ×”×©× ×™", "×§×œ×™××•×¤×˜×¨×”"], answer: "×—'×•×¤×•" },
            { fact: "××‘×Ÿ ×”×¨×•×–×˜×” ×”×™×™×ª×” ×”××¤×ª×— ×œ×¤×™×¢× ×•×— ×›×ª×‘ ×”×—×¨×˜×•××™× ×”××¦×¨×™.", question: "×‘××™×–×• ×©×¤×” × ×•×¡×¤×ª × ×›×ª×‘ ×”×˜×§×¡×˜ ×¢×œ ××‘×Ÿ ×”×¨×•×–×˜×”?", options: ["×¢×‘×¨×™×ª", "×™×•×•× ×™×ª ×¢×ª×™×§×”", "×œ×˜×™× ×™×ª", "×¢×¨×‘×™×ª"], answer: "×™×•×•× ×™×ª ×¢×ª×™×§×”" },
            { fact: "×”× ×™×œ×•×¡ × ×—×©×‘ ×œ××§×•×¨ ×”×—×™×™× ×©×œ ××¦×¨×™× ×”×¢×ª×™×§×” ×‘×–×›×•×ª ×”×¦×¤×•×ª×™×• ×”×¢×•× ×ª×™×•×ª.", question: "××™×–×” ×›×™×•×•×Ÿ ×–×•×¨× ×”× ×™×œ×•×¡?", options: ["×××¢×¨×‘ ×œ××–×¨×—", "××¦×¤×•×Ÿ ×œ×“×¨×•×", "××“×¨×•× ×œ×¦×¤×•×Ÿ", "×××–×¨×— ×œ××¢×¨×‘"], answer: "××“×¨×•× ×œ×¦×¤×•×Ÿ" },
            { fact: "×”×ª×”×œ×™×š ×©×œ ×—× ×™×˜×ª ×’×•×¤×•×ª × ×•×¢×“ ×œ×©××¨ ××ª ×”×’×•×£ ×œ×¢×•×œ× ×”×‘×.", question: "××™×š × ×§×¨××ª ×’×•×¤×” ×—× ×•×˜×” ×‘××¦×¨×™×?", options: ["×¤×¡×œ", "××•××™×”", "×¡×¨×§×•×¤×’", "×¤×¤×™×¨×•×¡"], answer: "××•××™×”" }
        ]},
        { name: "×”×§××ª ×”××“×™× ×”", category: "history", icon: "ğŸ‡®ğŸ‡±", type: "normal", data: [
            { fact: "×”×›×¨×–×ª ×”×¢×¦×××•×ª ×©×œ ×™×©×¨××œ × ×¢×¨×›×” ×‘-14 ×‘×××™ 1948 ×‘×ª×œ ××‘×™×‘.", question: "××™ ×§×¨× ××ª ××’×™×œ×ª ×”×¢×¦×××•×ª?", options: ["×—×™×™× ×•×™×¦××Ÿ", "×“×•×“ ×‘×Ÿ ×’×•×¨×™×•×Ÿ", "××©×” ×©×¨×ª", "×’×•×œ×“×” ×××™×¨"], answer: "×“×•×“ ×‘×Ÿ ×’×•×¨×™×•×Ÿ" },
            { fact: "×—×™×™× ×•×™×¦××Ÿ × ×‘×—×¨ ×œ×”×™×•×ª × ×©×™××” ×”×¨××©×•×Ÿ ×©×œ ××“×™× ×ª ×™×©×¨××œ.", question: "××” ×”×™×” ×ª×¤×§×™×“×• ×©×œ ×—×™×™× ×•×™×¦××Ÿ?", options: ["×¨××© ×××©×œ×”", "× ×©×™× ×”××“×™× ×”", "×©×¨ ×”×‘×™×˜×—×•×Ÿ", "×¨××˜×›\"×œ"], answer: "× ×©×™× ×”××“×™× ×”" },
            { fact: "××œ×—××ª ×”×¢×¦×××•×ª ×”×—×œ×” ××™×“ ×œ××—×¨ ×”×›×¨×–×ª ×”××“×™× ×”.", question: "××™×š × ×§×¨××ª ×”×ª×•×›× ×™×ª ×©×œ ×”××•\"× ××—×œ×•×§×ª ×”××¨×¥ ×‘-1947?", options: ["×ª×•×›× ×™×ª ×‘××–×œ", "×ª×•×›× ×™×ª ×”×—×œ×•×§×” (×›\"×˜ ×‘× ×•×‘××‘×¨)", "×ª×•×›× ×™×ª ××œ×•×Ÿ", "×”×¡×›××™ ××•×¡×œ×•"], answer: "×ª×•×›× ×™×ª ×”×—×œ×•×§×” (×›\"×˜ ×‘× ×•×‘××‘×¨)" },
            { fact: "×¦×”\"×œ ×”×•×§× ×©×‘×•×¢×™×™× ×œ××—×¨ ×”×›×¨×–×ª ×”××“×™× ×” ×¢×œ ×‘×¡×™×¡ ××¨×’×•×Ÿ ×”×”×’× ×”.", question: "××™ ×”×™×” ×”×¨××˜×›\"×œ ×”×¨××©×•×Ÿ ×©×œ ×¦×”\"×œ?", options: ["×™×¦×—×§ ×¨×‘×™×Ÿ", "×™×¢×§×‘ ×“×•×¨×™", "××©×” ×“×™×™×Ÿ", "×“×•×“ ××œ×¢×–×¨"], answer: "×™×¢×§×‘ ×“×•×¨×™" }
        ]}
        // × ×™×ª×Ÿ ×œ×”××©×™×š ×œ×”×•×¡×™×£ ×¢×“ 40 ×©×œ×‘×™× ×‘××•×ª×• ××‘× ×”...
    ];

    let currentSIdx = 0, currentQIdx = 0, score = 0, isQuiz = false, selectedOpt = null, timer = null;
    let filteredStages = stages;

    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('active'); }

    function refreshSidebar() {
        const stageNameEl = document.getElementById('side-stage-name');
        const scoreEl = document.getElementById('side-score');
        const isGameHidden = document.getElementById('sec-game').classList.contains('hidden');
        stageNameEl.innerText = isGameHidden ? "×‘×—×¨ × ×•×©×" : filteredStages[currentSIdx].name;
        scoreEl.innerText = score;
    }

    function init() {
        const saved = localStorage.getItem('mindstep_v8');
        if (saved) { score = JSON.parse(saved).sc || 0; }
        renderDashboard();
        refreshSidebar();
    }

    function save() { localStorage.setItem('mindstep_v8', JSON.stringify({ sc: score })); }

    function renderDashboard() {
        const grid = document.getElementById('dashboard-grid');
        grid.innerHTML = "";
        const categories = [...new Set(stages.map(s => s.category))];
        categories.forEach(cat => {
            const stage = stages.find(s => s.category === cat);
            const div = document.createElement('div');
            div.className = "col-6 col-md-4 col-lg-3";
            div.innerHTML = `<div class="category-card shadow-sm" onclick="selectCategory('${cat}')"><div class="category-icon">${stage.icon}</div><div class="fw-bold">${getCatHeb(cat)}</div></div>`;
            grid.appendChild(div);
        });
    }

    function getCatHeb(c) {
        return { tech: "×˜×›× ×•×œ×•×’×™×”", science: "××“×¢", history: "×”×™×¡×˜×•×¨×™×”", math: "××ª××˜×™×§×”", life: "×—×™×™×" }[c] || c;
    }

    function selectCategory(cat) {
        filteredStages = stages.filter(s => s.category === cat);
        currentSIdx = 0;
        document.getElementById('sec-dashboard').classList.add('hidden');
        document.getElementById('sec-game').classList.remove('hidden');
        startStage();
    }

    function showDashboard() {
        document.getElementById('sec-game').classList.add('hidden');
        document.getElementById('sec-dashboard').classList.remove('hidden');
        clearInterval(timer);
        refreshSidebar();
    }

    function startStage() {
        currentQIdx = 0; isQuiz = false; selectedOpt = null;
        document.getElementById('sec-quiz').classList.add('hidden');
        document.getElementById('sec-victory').classList.add('hidden');
        document.getElementById('ui-timer-box').classList.add('hidden');
        document.getElementById('sec-learning').classList.remove('hidden');
        updateUI();
    }

    function updateUI() {
        const stage = filteredStages[currentSIdx];
        const item = stage.data[currentQIdx];
        document.getElementById('ui-stage-badge').innerText = `×©×œ×‘ ${currentSIdx + 1} ××ª×•×š ${filteredStages.length}`;
        document.getElementById('ui-title').innerText = isQuiz ? "××‘×—×Ÿ ×©×œ×‘" : stage.name;
        document.getElementById('ui-progress').style.width = ((currentQIdx + 1) / stage.data.length * 100) + "%";
        
        const textEl = isQuiz ? document.getElementById('ui-question') : document.getElementById('ui-fact');
        textEl.innerText = isQuiz ? item.question : item.fact;
        if (isQuiz) renderOptions();
        refreshSidebar();
    }

    function renderOptions() {
        const item = filteredStages[currentSIdx].data[currentQIdx];
        const box = document.getElementById('ui-options');
        box.innerHTML = "";
        item.options.forEach(o => {
            const div = document.createElement('div');
            div.className = "col-12 col-md-6";
            div.innerHTML = `<div class="option-item ${selectedOpt === o ? 'selected' : ''}" onclick="selectOpt('${o}')">${o}</div>`;
            box.appendChild(div);
        });
    }

    function selectOpt(o) { selectedOpt = o; updateUI(); }

    function nextFact() {
        if (currentQIdx < filteredStages[currentSIdx].data.length - 1) { currentQIdx++; updateUI(); }
        else { isQuiz = true; currentQIdx = 0;
            document.getElementById('sec-learning').classList.add('hidden');
            document.getElementById('sec-quiz').classList.remove('hidden');
            if(filteredStages[currentSIdx].type === 'timed') startTimer();
            updateUI();
        }
    }

    function startTimer() {
        let t = filteredStages[currentSIdx].timeLimit;
        document.getElementById('ui-timer-box').classList.remove('hidden');
        document.getElementById('ui-time').innerText = t;
        timer = setInterval(() => {
            t--; document.getElementById('ui-time').innerText = t;
            if(t <= 0) { clearInterval(timer); alert("× ×’××¨ ×”×–××Ÿ!"); startStage(); }
        }, 1000);
    }

    function checkQuiz() {
        if(!selectedOpt) return alert("×‘×—×¨ ×ª×©×•×‘×”!");
        const item = filteredStages[currentSIdx].data[currentQIdx];
        const f = document.getElementById('ui-feedback');
        if (selectedOpt === item.answer) {
            score += 10; save();
            f.innerText = "âœ… × ×›×•×Ÿ!"; f.className = "text-success text-center my-3 fw-bold";
            setTimeout(() => {
                f.innerText = ""; selectedOpt = null;
                if (currentQIdx < filteredStages[currentSIdx].data.length - 1) { currentQIdx++; updateUI(); }
                else finishStage();
            }, 800);
        } else {
            f.innerText = "âŒ ×˜×¢×•×ª. × ×¡×” ×©×•×‘."; f.className = "text-danger text-center my-3 fw-bold";
            setTimeout(() => { f.innerText = ""; startStage(); }, 1200);
        }
    }

    function finishStage() {
        clearInterval(timer);
        document.getElementById('sec-quiz').classList.add('hidden');
        document.getElementById('sec-victory').classList.remove('hidden');
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        document.getElementById('ui-victory-msg').innerText = `×”×©×œ××ª ××ª ×©×œ×‘ ${filteredStages[currentSIdx].name}!`;
        currentSIdx++;
    }

    function startNextStage() {
        if (currentSIdx < filteredStages.length) startStage();
        else showDashboard();
    }

    function resetGame() { if(confirm("×œ××¤×¡ ×”×›×œ?")) { localStorage.clear(); location.reload(); } }

    init();
</script>
</body>
</html>